<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>JAMStack - Developer Days 2022</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css" id="theme">

		<!-- <style>
      @import url('//ed-style-system.cfapp.cac.dev.ms.otpp.net/icon8/css/styles.css');
      @import url('//ed-style-system.cfapp.cac.dev.ms.otpp.net/css/main.css');
    </style> -->

		<script type="module" src="dist/ed-component-library/ed-component-library.esm.js"></script>

		<link href='http://fonts.googleapis.com/css?family=Roboto:400,100,500,100italic|Roboto+Condensed:300italic,400,300,700|Open+Sans:400,300,600,700|Open+Sans+Condensed:300,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
		<!-- <link rel="stylesheet" href="dist/globals/vendor.css"> -->
		<!-- <link rel="stylesheet" href="dist/globals/styleguide.css"> -->

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">

		<style>
			/* Slide-specific vertical centering override */
			.reveal .slides section[data-vertical-align-top] {
				top: 0 !important;
			}

			.reveal .slides section[data-text-align-left] {
				text-align:left !important;
			}

			.reveal .slides section[data-override-style] .pbs-primary {
				color: #0D8296;
				font-size: 1.286rem;
				text-align: left;
			}

			.reveal .slides section[data-override-style] ed-feedback-block {
				font-size: 14px;
			}

			.reveal .slides section[data-override-style] ed-feedback-block ul {
				display: block;
			}

			.reveal .slides section[data-override-style] .control-label {
				top: 5rem;
			}

			.reveal .slides section h5 {
				font-size: 0.35em;
			}

			.reveal .hljs-ln-numbers {
				width: 50px;
			}

			.reveal pre {
				font-size: 0.40em;
			}

			.container{
				display: flex;
			}
			.col {
				flex: 1;
			}

			.any-question-cat {
				background:url("https://cdn.aarp.net/content/dam/aarp/disrupt_aging/2019/05/1140x655-curious-cat.jpg");
				background-position:center;
				background-size: 100%;
			}

			.good-question-cat {
				background:url("https://cutecatsanddogs.com/wp-content/uploads/2014/10/funny-videos-funny-cats-funny-ca1.jpg");
				background-position:center;
				background-size: 100%;
			}

			.thank-you-cat {
				background:url("https://external-preview.redd.it/ywgcDZgi2_flUucxfxEg8TFMI_Wng8aM9a3kBpjAl2E.jpg?auto=webp&s=2f9864ffea4bb398692f8b9140fa169318dce60e");
				background-position:center;
				background-size: 100%;
			}

			.thank-you-dog {
				background:url("https://i.pinimg.com/736x/b1/f5/fb/b1f5fbf539e9139db229418e8bd95487--cute-puppies-cute-dogs.jpg");
				background-position:center;
				background-size: 100%;
			}
		</style>

	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-transition="none">
					<h2>JAMStack</h2>
					<p>Developer Days 2022</p>
				</section>
				<section data-transition="none">
					<h2>What is it?</h2>
				</section>
				<section data-transition="none">
					<blockquote>Jamstack is an architectural approach that decouples the web experience layer from data and business logic, improving flexibility, scalability, performance, and maintainability</blockquote>
					<p>by Mathias Biilmann, co-founder at Netlify</p>
				</section>
				<section data-transition="none">
					<blockquote>If you are tired of hearing this from me, I'll try to spice this up a bit by trying to map this to TIM context as much as I can</blockquote>
				</section>
				<section data-transition="none">
					<div>here is what I want to cover today:</div>
					<ul>
						<li class="fragment fade-in">what?</li>
						<li class="fragment fade-in">why?</li>
						<li class="fragment fade-in">where?</li>
						<li class="fragment fade-in">key takeaways</li>
						<li class="fragment fade-in">q & a</li>
					</ul>
				</section>
				<section>
					<section>
						<h2>What?</h2>
					</section>
					<section data-transition="none">
					<div>What is component, really?</div>
					<blockquote class="fragment fade-in">"a part of element of a larger whole"</blockquote>
					<blockquote class="fragment fade-in">it can be small or large, for example</blockquote>
					<pre class="fragment fade-in">
						<code data-trim data-noescape><script type="text/template">
<tim-app-eaag></tim-app-eaag>
						</script></code>
					</pre>
					<blockquote class="fragment fade-in">entire app can be wrapped to a single component</blockquote>
					</section>
					<section data-transition="none">
						or collection of isolated components can work together
					<pre class="fragment fade-in">
						<code data-trim data-noescape><script type="text/template">
<tim-app-eaag>
	<tim-app-header></tim-app-header>
	<tim-employee-list></tim-employee-list>
	</tim-app-footer></tim-app-footer>
</tim-app-eaag>
						</script></code>
					</pre>
					<p class="fragment fade-in">and each component can further break into smaller components</p>
					<pre class="fragment fade-in">
						<code data-trim data-noescape><script type="text/template">
<tim-app-header>
  <tim-app-icon></tim-app-icon>
  <tim-app-link label="Work Centre"></tim-app-link>
  ...
  <tim-app-logout-button></tim-app-logout-button>
</tim-app-header>
						</script></code>
					</pre>
					</section>
				</section>
				<section>
					<section>
						<h2>Why?</h2>
					</section>
					<section>
					<blockquote>to build business features with isolation in mind</blockquote>
					</section>
					<section>
						<img src="http://src/storage/user/10/files/78351f80-c14e-11ec-85c3-f1c0ceb10de5">
					</section>
					<section>
						component integration means 2 parts
					</section>
					<section>
						part 1: pass data (props & attributes)
					</section>
					<section>
						you can pass string value naturally (it is actually passed as attribute) to component with
						<pre data-trim><code>
component-id="myTestId"
sso-token="{{clientExchange.getSSOToken()}}"
						</pre></code>
						<div class="fragment fade-in">
							but anything other than string, you need to use JavaScript code
							<pre data-trim><code>
document.querySelector('ed-modal').show = true;
							</pre></code>
						</div>
						<div class="fragment fade-in">
							with this, you can assign complex object but try to minimize the data set you need to pass down - based on my experience, that will simplify integration work :)
						</div>
					</section>
					<section>
						part 2: receive (& react to) event
					</section>
					<section>
						<img src="https://i.stack.imgur.com/dXs4X.png">
					</section>
					<section>
						In this presentation, I will be talking about the second part :)
					</section>
					<section>
						<blockquote>To provide simple, unified way to integrate AngularJS apps to <span style="color: red">event returned from (Stencil JS) components</span></blockquote>
					</section>
				</section>
				<section>
					<section>
						<h2>How?</h2>
					</section>
					<section>
						<pre><code data-line-numbers="|2-3" data-trim><script type="text/template">
<ed-add-message
  wc-event="clientExchange.reloadMessageList()"
  wc-event-name="addMessageSuccess"
  component-id="addMessageComponentId"
  irn="{{clientExchange.getIrn()}}"
  sso-token="{{clientExchange.getSSOToken()}}"
  analytics-hint="{{clientExchange.getAnalyticsHint()}}">
</ed-add-message>
						</script></code></pre>
						<div class="fragment fade-in">
							when you receive event called "addMessageSuccess", then call "clientExchange.reloadMessageList()"
						</div>
					</section>
					<section>
						<div>wc-event is a custom (attribute) directive</div>
						<div class="fragment fade-in">wc-event-name is just plain old attribute</div>
					</section>
					<section>
						<pre><code data-line-numbers="2-3" data-trim><script type="text/template">
<ed-add-message
  wc-event="clientExchange.reloadMessageList()"
  wc-event-name="addMessageSuccess">
  ...
</ed-add-message>
						</script></code></pre>
						<pre><code data-line-numbers="|3|5|6|7-10" data-trim><script type="text/template">
angular.module('home').directive('wcEvent', function($parse) {
  return {
    restrict: 'A',
    link: function(scope, element, attrs) {
      var eventName = attrs.wcEventName;
      var callback = $parse(attrs.wcEvent);
      element.on(eventName, ev => {
        console.log('successfully captured addMessageSuccess event from wc', ev);
        callback(scope);
      });
    }
  };
});
						</script></code></pre>
					</section>
					<section>
						this was "good enough" for ed-add-message and DocuSign integration :)
					</section>
					<section>
						but not good for ed-text-editor :(
					</section>
					<section>
						observation 1: need to receive data (from event)
					</section>
					<section>
						observation 2: need to tell AngularJS some (scope/component) data changed outside of its awareness
					</section>
					<section>
						<h2>Take 2</h2>
					</section>
					<section>
						<pre><code data-line-numbers="|2-3" data-trim><script type="text/template">
<ed-text-editor
  wc-event="$ctrl.updateText(event)"
  wc-event-name="textUpdate">
</ed-text-editor>
						</script></code></pre>
						<div class="fragment fade-in">
							when you receive event called "textUpdate", then call "$ctrl.updateText(event)" (notice how we have event as a parameter now)
						</div>
					</section>
					<section>
						<pre><code data-line-numbers="2-3" data-trim><script type="text/template">
<ed-text-editor
  wc-event="$ctrl.updateText(event)"
  wc-event-name="textUpdate">
</ed-text-editor>
						</script></code></pre>
						<pre><code data-line-numbers="|7,9-10" data-trim><script type="text/template">
angular.module('home').directive('wcEvent', function($parse) {
  return {
    restrict: 'A',
      link: function(scope, element, attrs) {
      var eventName = attrs.wcEventName;
      var callback = $parse(attrs.wcEvent);
      document.addEventListener(eventName, event => {
        console.log('successfully captured global event from wc', event);
        callback(scope, {event:event});
        scope.$apply();
      });
    }
  };
});
						</script></code></pre>
						<div class="fragment fade-in">
							<ul>
								<li class="fragment fade-in">pass 2nd parameter into callback - key-value pair object (these are argument to the function you put inside wc-event directive)</li>
								<li class="fragment fade-in">use scope.$apply() to run angularJS digest cycle (not ideal)</li>
							</ul>
						</div>
					</section>
					<section>
						This works but I want to look into scope.$apply() bit more 
					</section>
					<section>
						<h2>Take 3</h2>
					</section>
					<section>
						<pre><code data-line-numbers="|1,7,10" data-trim><script type="text/template">
angular.module('home').directive('wcEvent', function($parse, $window) {
  return {
    restrict: 'A',
    link: function(scope, element, attrs) {
      var eventName = attrs.wcEventName;
      var callback = $parse(attrs.wcEvent);
      $window.addEventListener(eventName, event => {
        console.log('successfully captured global event from wc', event);
        callback(scope, {event:event});
        //scope.$apply();
      });
    }
  };
});
						</script></code></pre>
						<div class="fragment fade-in">
							use $window and use it to register event listener - does it work? let's see!
						</div>						
					</section>
					<section data-background-iframe="wc-demo.html">
						<!-- <iframe src="wc-demo.html" frameborder="1" width="1600", height="700">

						</iframe> -->
					</section>
					<section>
						<div>What the ****?!</div>
						<img
							src="https://www.thedrakecenter.com/sites/default/files/styles/large/public/2021-06/cat-chewing-stick.png">
					</section>
					<section>
						So we end up using scope.$apply()
						<div class="fragment fade-in">
							Another side note, you can pass function to scope.$apply() and that is handy when you are executing 3rd party code that might fail.
						</div>
						<pre class="fragment fade-in"><code data-line-numbers="2-3|5-7" data-trim><script type="text/template">
//assume these code is inside link function
$(element).fancybox();
scope.$apply();

scope.$apply(() => {
  $(element).fancybox();
});
						</script></code></pre>
					</section>
					<section>
						<div>does wc-event works for all use cases?</div>
					</section>
					<section>
						<div>maybe yes, maybe no</div>
					</section>
					<section>
						<div>if you need to react to multiple events, this won't work "as-is"</div>
					</section>
					<section>
						we have few options:
						<ul>
							<li class="fragment fade-in">option 1: bind to another dom element (haven't try this but should work)</li>
							<li class="fragment fade-in">option 2: create another directive (like "wc-event-error")</li>
							<li class="fragment fade-in">option 3: extend and make wc-event aware of multiple events</li>
						</ul>
					</section>
					<section>
						<div>
							I'm NOT suggesting we should all use exactly same code - let's just align the approach, that's all :)
						</div>
					</section>
				</section>
				<section>
					<section>
						<h3>Key takeaways</h3>
					</section>
					<section>
						angular.component is a special kind of directive (isolated scope element directive)
					</section>
					<section>
						custom directive allow to expand existing DOM capability
					</section>
					<section>
						keep the data you pass down to components to minimal sets - simplfies integration work
					</section>
					<section>
						you can receive any object via event
					</section>
					<section>
						my desire is to align approaches among product team, not necessary the code itself
					</section>
				</section>
				<section>
					<section
						data-vertical-align-top
						data-state="any-question-cat">
						<h2 style="color: black">Any question?</h2>
					</section>
					<section 
						data-vertical-align-top
						data-state="good-question-cat">
						<h2>That's a good question!</h2>
					</section>
				</section>
				<section>
					<section
						data-vertical-align-top
						data-state="thank-you-cat">
						<h2 style="color: black">Meow! (Thank you!)</h2>
					</section>
					<section
						data-vertical-align-top
						data-state="thank-you-dog">
						<h2 style="color: black">Woof! (Thank you!)</h2>
					</section>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
